

\begin{tikzpicture}[]
  %Nodes
  \node[box] (a) {$f_a$};
  \node[box] (b) [right of=a, xshift=35mm] {$f_b$};

  \node[] (ai1) [left of=a, yshift=5mm] {};
  \node[] (ai2) [left of=a, yshift=-5mm] {};
  \node[] (aid) [left of=a, xshift=3mm] {$\cdots$};

  \path[line] (ai1) edge[-] (a);
  \path[line] (ai2) edge[-] (a);

  \node[] (bi1) [right of=b, yshift=5mm] {};
  \node[] (bi2) [right of=b, yshift=-5mm] {};
  \node[] (bid) [right of=b, xshift=-3mm] {$\cdots$};

  \path[line] (bi1) edge[-] (b);
  \path[line] (bi2) edge[-] (b);

  \path[line] (a) edge[-] 
  node[pos=0.1, yshift=1mm, anchor=south](mleft){\tiny $\obs{\mu}_{ai}$}
  node[pos=0.5, anchor=north, yshift=-1mm](si){$s_i$}
  % node[pos=0.5, qbox, label={[label distance=-2mm]above left:{\tiny $q(s_i)$}}](qsi){}
  node[pos=0.9, yshift=1mm, anchor=south](mright){\tiny $\obs{\mu}_{bi}$}
  (b);

  \node[box, yshift=0.8mm, node distance=6mm, inner sep=1mm, minimum size=0mm, minimum width=16mm] (combine) [above of=si] {\tiny \texttt{combineLatest}};
  \node[box, node distance=5.5mm, inner sep=1mm, minimum size=0mm, minimum width=16mm] (map) [above of=combine] {\tiny \texttt{map}};

  \path[line, densely dotted] (mleft) edge[-stealth] (combine);
  \path[line, densely dotted] (mright) edge[-stealth] (combine);
  \path[line, densely dotted] (combine) edge[-stealth] (map);

  %\node[box, densely dotted, inner xsep=2mm] (qsibbox) [fit=(combine)(map)] {};

  \node[node distance=5mm, xshift=-7mm] (qsi) [above of=map] {\tiny $\obs{q}_i(s_i)$};
  \node[node distance=6mm] (qsiempty) [above of=map] {};

  \path[line, densely dotted] (map) edge[-stealth] (qsiempty);

\end{tikzpicture}
